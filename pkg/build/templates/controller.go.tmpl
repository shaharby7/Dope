package main

import (
	"github.com/shaharby7/Dope/pkg/runtime/controller"
	"github.com/shaharby7/Dope/types"
    {{ range $index, $import := .Imports }}
    "{{ $import }}"{{ end }}
)

var controllers = map[string]types.Controller[any]{
{{ range $index, $controller := .Controllers }}
    "{{ $controller.Name }}": {{ $controller.Identifier }},
{{ end  }}
}

{{ range $index, $controller := .Controllers }}
var {{ $controller.Identifier }} = controller.NewHTTPServer(
	types.HTTPServerConfig{Port: 3000},
	[]*types.TypedAction{
		types.CreateTypedAction(
            {{ range $index, $action := $controller.Actions }}
			&types.ActionConfig{
				Name: "{{ $action.Name }}",
				ControllerBinding: &types.HTTPSeverActionConfig{
					Method: types.POST,
				},
			},
            {{ $action.Caller}},
            ),
            {{ end }}
	},
)
{{ end }}

